<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <template id="checkout_dermanord" name="Checkout Dermanord" inherit_id="website_sale.checkout">
            <xpath expr="//input[@name='name']/.." position="attributes">
                <attribute name="t-attf-class">form-group #{error.get('name') and 'has-error' or ''} col-lg-6 hidden</attribute>
            </xpath>
            <xpath expr="//input[@name='street']/.." position="attributes">
                <attribute name="t-attf-class">form-group #{error.get('street') and 'has-error' or ''} col-lg-6 hidden</attribute>
            </xpath>
            <xpath expr="//input[@name='vat']/.." position="attributes">
                <attribute name="t-attf-class">form-group #{error.get('vat') and 'has-error' or ''} col-lg-6 hidden</attribute>
            </xpath>
            <xpath expr="//input[@name='email']/.." position="attributes">
                <attribute name="t-attf-class">form-group #{error.get('email') and 'has-error' or ''} col-lg-6 hidden</attribute>
            </xpath>
            <xpath expr="//input[@name='phone']/.." position="attributes">
                <attribute name="t-attf-class">form-group #{error.get('phone') and 'has-error' or ''} col-lg-6 hidden</attribute>
            </xpath>
            <xpath expr="//input[@name='street2']/.." position="attributes">
                <attribute name="t-attf-class">form-group #{error.get('street2') and 'has-error' or ''} col-lg-6 hidden</attribute>
            </xpath>
            <xpath expr="//input[@name='city']/.." position="attributes">
                <attribute name="t-attf-class">form-group #{error.get('city') and 'has-error' or ''} col-lg-6 hidden</attribute>
            </xpath>
            <xpath expr="//input[@name='zip']/.." position="attributes">
                <attribute name="t-attf-class">form-group #{error.get('zip') and 'has-error' or ''} col-lg-6 hidden</attribute>
            </xpath>
            <xpath expr="//select[@name='country_id']/.." position="attributes">
                <attribute name="t-attf-class">form-group #{error.get('country_id') and 'has-error' or ''} col-lg-6 hidden</attribute>
            </xpath>
            <xpath expr="//select[@name='state_id']/.." position="attributes">
                <attribute name="t-attf-class">form-group #{error.get('state_id') and 'has-error' or ''} col-lg-6 hidden</attribute>
            </xpath>
            
            <xpath expr="//h3[@class='page-header mt16']" position="replace">
                
            </xpath>
            
            <xpath expr="//select[@name='shipping_id']/option[@value='-1']" position="replace">
                
            </xpath>
            
            <xpath expr="//div[@class='js_shipping row mb16']" position="attributes">
                <attribute name="t-att-style">'display:none'</attribute>
            </xpath>
            
            <xpath expr="//select[@name='shipping_id']/.." position="after">
                <div class="form-group col-lg-12">
                    <label>Invoicing</label>
                    <select name="invoicing_id" class="form-control">
                        <option value="0">Invoice to the same address</option>
                        <t t-foreach="invoicings" t-as="invoicing">
                            <option t-att-value="invoicing.id" t-att-selected="invoicing.id == invoicing_id"><t t-esc="', '.join('\n'.join(invoicing.name_get()[0][1].split(',')).split('\n')[1:])"/></option>
                        </t>
                    </select>
                </div>
            </xpath>
            
            
            
<!--
                  <div t-if="has_check_vat" class="clearfix"/>

                  <div class="clearfix"/>

                  <div class="clearfix"/>
-->
            <xpath expr="//div[@class='col-lg-offset-1 col-lg-3 col-md-3 text-muted']" position="inside">
                <t t-if="user_id != website.env.ref('base.public_user')">
                    <h3 class="page-header mt16">Contact Information</h3>
                    <div class="row">
                        <div t-field="user_id.partner_id" t-field-options='{
                            "widget": "contact",
                            "fields": ["name", "address", "phone", "mobile", "email"]}'/>
                    </div>
                    
                    <h3 class="page-header mt16">Shipping Address</h3>
                    <div id="shipping_addr_0" t-att-class="'row shipping-address hidden' if shipping_id != 0 else 'row shipping-address'">
                        <div t-field="user_id.partner_id" t-field-options='{
                            "widget": "contact",
                            "fields": ["name", "address", "phone", "mobile", "email"]}'/>
                    </div>
                    <t t-foreach="shippings" t-as="shipping">
                        <div t-att-id="'shipping_addr_%s' % shipping.id" t-att-class="'row shipping-address hidden' if shipping.id != shipping_id else 'row shipping-address'">
                            <t t-raw='shipping.address_to_html({
                                "widget": "contact",
                                "fields": ["name", "address", "phone", "mobile", "email"]})'/>
                        </div>
                    </t>
                    
                    <h3 class="page-header mt16">Invoice Address</h3>
                    <div id="invoicing_addr_0" t-att-class="'row invoicing-address hidden' if invoicing_id != 0 else 'row invoicing-address'">
                        <div t-field="user_id.partner_id" t-field-options='{
                            "widget": "contact",
                            "fields": ["name", "address", "phone", "mobile", "email"]}'/>
                    </div>
                    <t t-foreach="invoicings" t-as="invoicing">
                        <div t-att-id="'invoicing_addr_%s' % invoicing.id" t-att-class="'row invoicing-address hidden' if invoicing.id != invoicing_id else 'row invoicing-address'">
                            <t t-raw='invoicing.address_to_html({
                                "widget": "contact",
                                "fields": ["name", "address", "phone", "mobile", "email"]})'/>
                        </div>
                    </t>
                </t>
                
                
            </xpath>

        </template>
        
<!--
        <template id="remove_header" inherit_id="website_sale_invoice.sale_invoice_address" name="Checkout Address Remove Header">
            <xpath expr="//h3" position="replace">
                <h3 class="page-header mt16">
                    <small groups="base.group_public">
                        <a class="btn btn-primary" t-if="not partner" t-attf-href="/web?redirect=#{ request.httprequest.url }">Sign in</a>
                    </small>
                </h3>
            </xpath>
        </template>
-->

        <template id="search_result" inherit_id="website_fts.search_result">
            <xpath expr="//t[@t-foreach='terms']" position="replace">
                <script>var dermanord_kw = "<t t-esc='kw'/>";</script>
                <t t-foreach="terms" t-as="term">
                    <t t-if="term.res_model == 'product.template'">
                        <t t-if="len(term.model_record.sudo().access_group_ids) == 0 or (len(term.model_record.sudo().access_group_ids) &gt; 0 and user_id in term.model_record.sudo().access_group_ids.mapped('users'))">
                            <div class="col-md-12 col-sm-12 col-xs-12 mt16">
                                <div class="col-md-3 col-sm-3 col-xs-3">
                                    <t t-if="term.model_record.image">
                                        <img class="img img-responsive" t-att-src="'/imagefield/product.template/image/%s/ref/%s' %(term.res_id, 'webshop_dermanord.img_search_result')"/>
                                    </t>
                                    <t t-if="not term.model_record.image">
                                        <img class="img img-responsive" src="/website_logo.png"/>
                                    </t>
                                </div>
                                <div class="col-md-9 col-sm-9 col-xs-9">
                                    <a t-att-href="'/dn_shop/product/%s' %term.res_id">
                                        <h4><t t-esc="term.model_record.name"/> [Product]</h4>
                                    </a>
                                    <p class="text-muted result_desc"><t t-esc="term.model_record.description_sale"/></p>
                                </div>
                            </div>
                        </t>
                    </t>
                    <t t-if="term.res_model == 'product.product'">
                        <t t-if="len(term.model_record.sudo().access_group_ids) == 0 or (len(term.model_record.sudo().access_group_ids) &gt; 0 and user_id in term.model_record.sudo().access_group_ids.mapped('users'))">
                            <div class="col-md-12 col-sm-12 col-xs-12 mt16">
                                <div class="col-md-3 col-sm-3 col-xs-3">
                                    <t t-if="term.model_record.image">
                                        <img class="img img-responsive" t-att-src="'/imagefield/product.product/image/%s/ref/%s' %(term.res_id, 'webshop_dermanord.img_search_result')"/>
                                    </t>
                                    <t t-if="not term.model_record.image">
                                        <img class="img img-responsive" src="/website_logo.png"/>
                                    </t>
                                </div>
                                <div class="col-md-9 col-sm-9 col-xs-9">
                                    <a t-att-href="'/dn_shop/variant/%s' %term.res_id">
                                        <h4><t t-esc="term.model_record.name"/> [Product]</h4>
                                    </a>
                                    <p class="text-muted"><t t-esc="term.model_record.default_code"/></p>
                                    <t t-foreach="term.model_record.attribute_value_ids" t-as="value">
                                        <span class="dn_tags" t-esc="'%s ' %value.name"/>
                                    </t>
                                    <p class="text-muted result_desc"><t t-esc="term.model_record.product_tmpl_id.description_sale"/></p>
                                </div>
                            </div>
                        </t>
                    </t>
                    <t t-if="term.res_model == 'product.public.category'">
                        <div class="col-md-12 col-sm-12 col-xs-12 mt16">
                            <div class="col-md-3 col-sm-3 col-xs-3">
                                <t t-if="term.model_record.image_medium">
                                    <img class="img img-responsive" t-att-src="'/imagefield/product.public.category/image_medium/%s/ref/%s' %(term.res_id, 'webshop_dermanord.img_search_result')"/>
                                </t>
                                <t t-if="not term.model_record.image_medium">
                                    <img class="img img-responsive" src="/website_logo.png"/>
                                </t>
                            </div>
                            <div class="col-md-9 col-sm-9 col-xs-9">
                                <a t-att-href="'/dn_shop/category/%s' %term.res_id">
                                    <h4><t t-esc="term.model_record.name"/> [Category]</h4>
                                </a>
                            </div>
                        </div>
                    </t>
                    <t t-if="term.res_model == 'blog.post'">
                        <div class="col-md-12 col-sm-12 col-xs-12 mt16">
                            <div class="col-md-3 col-sm-3 col-xs-3">
                                <t t-if="term.model_record.background_image">
                                    <img class="img img-responsive" t-att-src="'/imagefield/blog.post/background_image/%s/ref/%s' %(term.res_id, 'webshop_dermanord.img_search_result')"/>
                                </t>
                                <t t-if="not term.model_record.background_image">
                                    <img class="img img-responsive" src="/website_logo.png"/>
                                </t>
                            </div>
                            <div class="col-md-9 col-sm-9 col-xs-9">
                                <a t-att-href="'/blog/%s/post/%s' %(request.env['blog.post'].browse(term.res_id).blog_id.id, term.res_id)">
                                    <h4><t t-esc="term.model_record.name"/> [Blog Post]</h4>
                                </a>
                                <p class="text-muted result_desc"><t t-esc="term.model_record.subtitle"/></p>
                            </div>
                        </div>
                    </t>
                    <t t-if="term.res_model == 'product.facet.line'">
                        <div class="col-md-12 col-sm-12 col-xs-12 mt16">
                            <div class="col-md-3 col-sm-3 col-xs-3">
                                <t t-if="term.model_record.product_tmpl_id.image">
                                    <img class="img img-responsive" t-att-src="'/imagefield/product.template/image/%s/ref/%s' %(term.model_record.product_tmpl_id.id, 'webshop_dermanord.img_search_result')"/>
                                </t>
                                <t t-if="not term.model_record.product_tmpl_id.image">
                                    <img class="img img-responsive" src="/website_logo.png"/>
                                </t>
                            </div>
                            <div class="col-md-9 col-sm-9 col-xs-9">
                                <a t-att-href="'/dn_shop/product/%s' %term.model_record.product_tmpl_id">
                                    <h4><t t-esc="term.model_record.product_tmpl_id.name"/> [Facet]</h4>
                                </a>
                                <t t-foreach="term.model_record.product_tmpl_id.facet_line_ids.with_context({'res_id': term.res_id}).filtered(lambda f: f.id == f._context.get('res_id'))[0].value_ids" t-as="value">
                                    <span class="dn_facets" t-esc="'%s ' %value.name"/>
                                </t>
                                <p class="text-muted result_desc"><t t-esc="term.model_record.product_tmpl_id.description_sale"/></p>
                            </div>
                        </div>
                    </t>
                </t>
            </xpath>
        </template>

        <template id="webshop_dermanord" inherit_id="website.layout" name="Webshop Dermanord">
            <!-- Customize css -->
            <xpath expr="//t[@t-call-assets='website.assets_frontend']" position="before">
                <link href="/webshop_dermanord/static/src/css/webshop_dermanord.css" rel="stylesheet" />
            </xpath>
        </template>

        <template id="assets_frontend_override" inherit_id="website_sale.assets_frontend">
            <!-- Customize javascript -->
            <xpath expr="//script[@src='/website_sale/static/src/js/website_sale.js']" position="replace">
                <script type="text/javascript" src="/webshop_dermanord/static/src/js/webshop_dermanord.js" />
            </xpath>
            <xpath expr="//script[last()]" position="after">
                <script type="text/javascript" src="/webshop_dermanord/static/src/js/webshop_search.js" />
            </xpath>
        </template>

        <template id="assets_frontend_fts_override" inherit_id="website_fts.assets_frontend">
            <!-- override fts javascript -->
            <xpath expr="//script[@src='/website_fts/static/src/js/main.js']" position="replace">
                <script type="text/javascript" src="/webshop_dermanord/static/src/js/fts_search.js" />
            </xpath>
        </template>

        <record id="product_pricelist_item_tree_view" model="ir.ui.view">
            <field name="name">product.pricelist.item.tree.surcharge</field>
            <field name="model">product.pricelist.item</field>
            <field name="inherit_id" ref="product.product_pricelist_item_tree_view" />
            <field name="arch" type="xml">
                <field name="min_quantity" position="after">
                    <field name="price_surcharge"/>
                </field>
            </field>
        </record>

        <record id="view_blog_post_form" model="ir.ui.view">
            <field name="name">blog.post.form.webshop</field>
            <field name="model">blog.post</field>
            <field name="inherit_id" ref="website_blog.view_blog_post_form" />
            <field name="arch" type="xml">
                <sheet position="inside">
                    <group>
                        <field name="product_tmpl_ids" widget="many2many_tags" />
                        <field name="product_public_categ_ids" widget="many2many_tags" />
                    </group>
                </sheet>
            </field>
        </record>

        <record id="product_public_category_form_view" model="ir.ui.view">
            <field name="name">product.public.category.form.inherited.webshop_dermanord</field>
            <field name="model">product.public.category</field>
            <field name="inherit_id" ref="website_sale.product_public_category_form_view"/>
            <field name="arch" type="xml">
                <field name="sequence" position="attributes">
                    <attribute name="widget">handle</attribute>
                </field>
            </field>
        </record>

        <record id="product_pricelist_view" model="ir.ui.view">
            <field name="name">product.pricelist.form.inherited.webshop_dermanord</field>
            <field name="model">product.pricelist</field>
            <field name="inherit_id" ref="product.product_pricelist_view"/>
            <field name="arch" type="xml">
                <field name="active" position="after">
                    <field name="for_reseller"/>
                </field>
            </field>
        </record>

        <record id="product_template_form_view" model="ir.ui.view">
            <field name="name">product.template.common.form.inherited.webshop_dermanord</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="product.product_template_form_view"/>
            <field name="arch" type="xml">
                <field name="list_price" position="after">
                    <field name="sold_qty"/>
                </field>
            </field>
        </record>

<!--
        <record id="product_normal_form_view" model="ir.ui.view">
            <field name="name">product.product.form.inherited.webshop_dermanord</field>
            <field name="model">product.product</field>
            <field name="inherit_id" ref="product.product_normal_form_view"/>
            <field name="arch" type="xml">
                <field name="list_price" position="after">
                    <field name="sold_qty"/>
                </field>
            </field>
        </record>
-->

    </data>
</openerp>
