<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <!-- News Template -->
        <template id="news_list" name="News List">
            <t t-call="website.layout">
                <div id="wrap">
                    <t t-set="no_breadcrumb" t-value="True"/>
                    <t t-set="news_blog_url" t-value="'/blog/%s' %blog.id"/>
                    <div class="container dn_header" style="width: 100%; padding: 0px;">
                        <div t-if="news_blog_url and website.current_submenu(news_blog_url).child_id" class="col-md-12 col-sm-12 col-xs-12 dn_header_banner">
                            <div class="col-md-2 col-sm-2 col-xs-12 dn_header_nav">
                                <ul class="nav nav-pills nav-stacked">
                                    <t t-set="current_path" t-value="request.httprequest.path"/>
                                    <t t-if="'/tag/' in current_path">
                                        <t t-set="current_blog_id" t-value="current_path[(current_path.index('/blog/')+len('/blog/')):current_path.index('/tag/')].split('-')[-1]"/>
                                        <t t-set="current_tag_id" t-value="current_path.split('/tag/')[-1].split('-')[-1]"/>
                                        <t t-set="current_path" t-value="'/blog/%s/tag/%s' %(current_blog_id, current_tag_id)"/>
                                    </t>
                                    <t t-foreach="website.current_submenu(news_blog_url).child_id" t-as="submenu">
                                        <li t-att-class="'hidden-xs %s' %('active' if submenu.url == current_path else '')">
                                            <a t-att-href="submenu.url" class="dn_header_nav_tab" style="padding: 5px 10px !important;">
                                                <span class="text-center dn_uppercase">
                                                    <t t-esc="submenu.name"/>
                                                </span>
                                            </a>
                                        </li>
                                        <li class="hidden-lg hidden-md hidden-sm">
                                            <a t-att-href="submenu.url" class="dn_header_nav_tab" style="padding: 5px 10px !important;">
                                                <span class="text-center dn_uppercase">
                                                    <t t-esc="submenu.name"/>
                                                </span>
                                            </a>
                                        </li>
                                    </t>
                                </ul>
                            </div>
                            <div class="col-md-10 col-sm-10 hidden-xs" style="padding: 0px;">
                                <div class="dn_header_container">
                                    <t t-set="current_menu" t-value="website.current_menu(request.httprequest.path)"/>
                                    <span itemprop="image" t-field="current_menu.image" t-field-options='{"widget": "image", "class": "css_non_editable_mode_hidden", "alt-field": "name"}'/>
                                    <img class="img img-responsive css_editable_mode_hidden" t-att-src="'/imagefield/website.menu/image/%s/ref/theme_dermanord.dn_header_img' %current_menu.id"/>
                                    <h6 class="page_title">
                                        <span class="" t-field="current_menu.page_title"/>
                                    </h6>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="container mb32">
                        <div class="row">
                            <t t-set="news_blog" t-value="request.env['blog.post'].search([('blog_id', '=', blog.id), ('website_published', '=', True)])"/>
                            <t t-if="'/tag/' in request.httprequest.path">
                                <t t-set="current_tag_id" t-value="request.httprequest.path.split('/tag/')[-1].split('-')[-1]"/>
                                <t t-set="news_blog" t-value="request.env['blog.post'].search([('blog_id', '=', blog.id), ('tag_ids', 'in', int(current_tag_id)), ('website_published', '=', True)])"/>
                            </t>
                            <t t-foreach="news_blog" t-as="news_post">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <t t-if="news_post.background_image and '/ir.attachment/' in news_post.background_image">
                                        <div class="col-md-6 col-sm-6 col-xs-12 mt16 mb16 blog_background_image_list" t-att-style="'background-image: url(&quot;/imagefield/ir.attachment/datas/%s/ref/theme_dermanord.dn_header_img&quot;);' %news_post.background_image[(news_post.background_image.index('ir.attachment/')+len('ir.attachment/')):news_post.background_image.index('/datas')].split('_')[0]"/>
                                    </t>
                                    <t t-if="not news_post.background_image or '/ir.attachment/' not in news_post.background_image">
                                        <div class="col-md-6 col-sm-6 col-xs-12 mt16 mb16 blog_background_image_list"/>
                                    </t>
<!--
                                    <div class="col-md-6 col-sm-6 col-xs-12 mt16 mb16 blog_background_image_list" t-att-style="'background-image: url(&quot;/%s&quot;);' %'/'.join(news_post.background_image.split('//')[1].split('/')[1:])"/>
-->
                                    <div class="col-md-6 col-sm-6 col-xs-12 mt16 mb16 blog_content_div">
                                        <h6 t-field="news_post.name"/>
                                        <h4 class="text-muted"><t t-esc="str(news_post.write_date)[:10]"/></h4>
                                        <p t-field="news_post.subtitle" class="text-muted mt16"/>
                                        <a t-att-href="'/blog/%s/post/%s' %(news_post.blog_id.id, news_post.id)"><p style="text-decoration: underline; color: #000;">Read more</p></a>
                                        <div class="blog_tag_div">
                                            <h4 class="dn_uppercase blog_content_tag">tags:</h4>
                                            <t t-foreach="news_post.tag_ids" t-as="tag">
                                                <a t-att-href="'/blog/%s/tag/%s' %(news_post.blog_id.id, tag.id)"><span t-field="tag.name" class="post_tag dn_uppercase"/></a>
                                            </t>
                                        </div>
                                    </div>
                                </div>
                            </t>
                        </div>
                    </div>
                </div>
            </t>
        </template>
        <template id="news_detail" name="News Detail">
            <t t-call="website_blog.index">
                <div class="cover js_fullheight" id="title" t-attf-style="background-image: url(#{blog_post.background_image})" t-ignore="True">
                    <div class="container">
                      <div class="container text-right mt16">
                        <div class="btn-group css_non_editable_mode_hidden">
                            <a id="change_cover" class="btn btn-primary">
                                Change Cover
                            </a>
                            <a id="clear_cover" class="btn btn-danger">
                                <span class="fa fa-times"/>
                            </a>
                        </div>
                        <div class="cover-storage oe_hidden"></div>
                        <t t-call="website.publish_management">
                            <t t-set="object" t-value="blog_post"/>
                            <t t-set="publish_edit" t-value="True"/>
                            <li>
                                <form class="duplicate hidden" action="/blogpost/duplicate">
                                    <input name="blog_post_id" t-att-value="blog_post.id"/>
                                </form>
                                <a href="#" class="duplicate" onclick="$(this).prev('form').submit()">Duplicate</a>
                            </li>
                        </t>
                      </div>
                    </div>
                </div>
                <div id="blog_block" class="container mt32 mb32">
                    <h6 t-field="blog_post.name" id="blog_post_name" t-att-data-blog-id="blog_post.id"/>
                    <h4 class="text-muted"><t t-esc="str(blog_post.write_date)[:10]"/></h4>
                    <div id="blog_content" t-field="blog_post.content" class="mt32"/>
                    <h4 class="dn_uppercase mt32">tags:</h4>
                    <t t-foreach="blog_post.tag_ids" t-as="tag">
                        <a t-att-href="'/blog/%s/tag/%s' %(blog_post.blog_id.id, tag.id)"><span t-field="tag.name" class="post_tag dn_uppercase"/></a>
                    </t>
                </div>
                <div class="container mt32 mb32">
                    <t t-call="website_blog_dermanord.blog_post_products"/>
                </div>
            </t>
        </template>
        <!-- News Dermanord -->
        <template id="page" name="News Dermanord">
            <t t-call="website.layout">
                <p t-att-id="request.env.ref('press_dermanord.image_thumbnail').id" class="thumbnail_recipe hidden"/>
                <p t-att-id="request.env.ref('press_dermanord.image_website').id" class="website_recipe hidden"/>
                <p t-att-id="request.env.ref('press_dermanord.image_original').id" class="original_recipe hidden"/>
                <section>
                    <div class="container mt16 mb16 a_bord">
                        <div class="col-md-3 col-sm-3 col-xs-12 b_bord">
                            <div id="press_ansvarig_block" class="container text-center mt16 mb16 c_bord">
                                <t t-set="press_ansvarig" t-value="request.env['hr.employee.category'].browse(request.env.ref('press_dermanord.press_responsible').id).employee_ids[0]" />
                                <h3>Pressansvarig</h3>
                                <t t-if="press_ansvarig">
                                    <h4 t-field="press_ansvarig.name" />
                                    <h4 t-field="press_ansvarig.work_phone" />
                                    <h4 t-field="press_ansvarig.work_email" />
                                </t>
                                <t t-if="not press_ansvarig">
                                    <h3>No News Responsible</h3>
                                </t>
                            </div>
                        </div>
                        <div class="col-md-9 col-sm-9 col-xs-12 b_bord">
                            <t t-call="press_dermanord.press_release_block" />
                        </div>
                    </div>

                </section>
                <section />
            </t>
        </template>

        <template id="news_dermanord_css" inherit_id="website.layout" name="News Dermanord CSS">
            <!-- Customize css -->
            <xpath expr="//t[@t-call-assets='website.assets_frontend']" position="before">
                <link href="/news_dermanord/static/src/css/main.css" rel="stylesheet" />
            </xpath>
        </template>

        <template id="customer_js" inherit_id="website.layout">
            <xpath expr="//body" position="inside">
                <script type="text/javascript" src="/news_dermanord/static/src/js/main.js" />
            </xpath>
        </template>

<!-- Blog Post List: Displaying a list of Blog Posts -->
<template id="post" name="News Posts">



                  <div class="text-muted">
                      <h4
                        t-field="blog_post.subtitle"
                        class="mb4 mt4"/>
                    <div name='blog_post_data' class='mb0'>
                         <span t-field="blog_post.author_id" style="display: inline-block;" t-field-options='{
                                "widget": "contact",
                                "fields": ["name"]
                            }'/>
                        &#5760; <span t-field="blog_post.create_date" t-field-options='{"format": "MMMM yyyy"}'/>
                        <span t-if="len(blog_post.message_ids) &gt; 0">
                            &#5760; <t t-esc="len(blog_post.message_ids)"/>
                            <t t-if="len(blog_post.message_ids) &lt;= 1" >comment</t>
                            <t t-if="len(blog_post.message_ids) > 1">comments</t>
                        </span>

                        <span t-if="not blog_post.website_published" class="label label-danger">not published</span>
                    </div>
                  </div>



        <div class="oe_structure"/>

</template>



    </data>
</openerp>
