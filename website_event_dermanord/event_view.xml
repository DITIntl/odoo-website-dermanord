<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <template id="event_description_full" name="Events Dermanord" inherit_id="website_event.event_description_full">
            <xpath expr="//div[@class='col-md-4 css_noprint']/div[@class='panel panel-default'][4]" position="replace">
            </xpath>
            <xpath expr="//div[@itemprop='location']" position="replace">
                <div itemprop="location" class="mt16 mb8" t-field="event.address_id" t-field-options='{
                    "widget": "contact",
                    "no_marker": 1,
                    "fields": ["address", "phone", "mobile", "fax", "email"]
                    }'/>
            </xpath>
            <xpath expr="//a[@t-att-href='event.google_map_link()']" position="replace">
                <t t-call="website_partner_google_maps.google_maps">
                    <t t-set="div_class" t-value="'mt16'"/>
                    <t t-set="width" t-value="'100%'"/>
                    <t t-set="height" t-value="'400px'"/>
                    <t t-set="zoom" t-value="12"/>
                    <t t-set="center" t-value="event.address_id"/>
                    <t t-set="partners" t-value="event.address_id"/>
                    <t t-set="icon" t-value="'/website_event_dermanord/static/src/img/dn_maps_marker.png'"/>
                    <t t-set="api_key" t-value="request.env['ir.config_parameter'].get_param('google_maps_api')"/>
                </t>
            </xpath>
        </template>

        <template id="layout" inherit_id="website_event.layout" >
            <xpath expr="//div[@id='event_menu']" position="replace"/>
        </template>

        <template id="website_event.event_left_column" inherit_id="website_event.index" name="Dermanord Filters">
            <xpath expr="//div[@id='middle_column']" position="attributes">
            <attribute name="class">col-md-6</attribute>
            </xpath>
            <xpath expr="//div[@id='middle_column']" position="before">
                <div class="col-md-3 css_noprint" id="left_column">
                    <ul class="nav nav-pills nav-stacked">
                        <t t-foreach="dates" t-as="date">
                            <li t-att-class="searches.get('date') == date[0] and 'active' or ''" t-if="date[0] != 'old' and (date[3] or (date[0] in ('old','all')))">
                                <a t-attf-href="/event?{{ keep_query('country', 'type', date=date[0]) }}"><t t-esc="date[1]"/>
                                    <span t-if="date[3]" class="badge pull-right"><t t-esc="date[3]"/></span>
                                </a>
                            </li>
                        </t>
                    </ul>
                </div>
            </xpath>
        </template>

        <template id="index" inherit_id="website_event.index">
             <xpath expr="//ol[@class='breadcrumb mb0']" position="replace"/>
             <xpath expr="//div[@itemprop='location']" position="replace">
                <div itemprop="location" t-field="event.address_id" t-field-options='{
                    "widget": "contact",
                    "no_marker": 1,
                    "fields": ["city"]
                    }'/>
            </xpath>
        </template>

        <template id="event_description_full_website_event_sale" inherit_id="website_event_sale.event_description_full" name="Inherit Website Event Sale event_description_full">
            <xpath expr="//button[@type='submit']" position="replace">
                <t t-if="event.event_ticket_ids.filtered(lambda t: not t.is_expired)">
                    <button type="submit" class="btn btn-primary btn-lg pull-right" t-if="event.seats_available or not event.seats_max">Order Now</button>
                </t>
                <t t-if="not event.event_ticket_ids.filtered(lambda t: not t.is_expired)">No bookable activities</t>
            </xpath>
        </template>

        <record id="view_event_form" model="ir.ui.view">
            <field name="name">view_event_form.inherited.website_event_dermanord</field>
            <field name="model">event.event</field>
            <field name="inherit_id" ref="event.view_event_form"/>
            <field name="arch" type="xml">
                <field name="seats_used" position="after">
                    <field name="seats_available"/>
                </field>
            </field>
        </record>

    </data>
</openerp>
